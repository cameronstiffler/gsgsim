# .copilot-instructions.md — GSG Sim Guardrails (authoritative)

## Golden Rules
- DO NOT move or duplicate imports. Keep all imports in the "Import Sentry" at the top of `gsg_sim.py`.
- DO NOT create duplicate classes or functions. Edit the canonical definition in place.
- DO NOT change public function signatures or class field names unless explicitly instructed.
- Use Rich for the optional UI (`rich.console`, `rich.table`) — this is allowed.
- Use Black (LL=100), isort, autoflake, flake8. Code must pass `python -m py_compile`.

## Canonical Data Model
- `Player` has: `board`, `hand`, `deck`, `retired`, `gear`, `meat`, `power`.
- `Card` has: `name`, `rank`, `abilities`, `wind`, and optionally `new_this_turn` (bool).
- Board attribute is named **`board`** (never `.field`).

## Canonical APIs
- `distribute_wind(owner: Player, total: int, *, auto: bool = False, allow_cancel: bool = False) -> Optional[bool]`
- `apply_wind_with_resist(attacker_owner, defender_owner, target, amount) -> int`
- `deploy_from_hand(gs, player, hand_idx) -> bool`
- `start_of_turn(gs)`, `end_of_turn(gs)`, `use_ability_cli(...)`
- UI: `TerminalUI` and `RichUI` each have a single `run_loop`.

## Workstyle
- Make the smallest possible change. If a step is ambiguous, stop and emit questions instead of guessing.
- Prefer explicit helper functions over inlining complex logic.
- Keep long strings under 100 chars via implicit concatenation in parentheses.

## Done Criteria
- `autoflake`, `isort`, `black`, `flake8` pass.
- `python -m py_compile gsg_sim.py` passes.
- `python gsg_sim.py --ui rich` runs; `deploy 0` does not crash; `end` swaps turns.